<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Pickleball Swipe Scorer</title>
  <style>
    :root{
      --bg:#0c0c0f; --muted:#6b7280; --panel:#111218; --blue:#3ba3ff; --red:#ff4d4d; --white:#ffffff; --green:#39e075; --divider:#23242c;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:#e5e7eb;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji"}
    .app{height:100%;display:grid;grid-template-rows:auto 1fr auto;}

    /* top controls */
    .top{position:relative;padding:18px 14px 6px;}
    .names{display:grid;grid-template-columns:1fr 1fr;align-items:center;gap:8px;opacity:.7;font-weight:700;letter-spacing:.3px}
    .names .cell{display:flex;align-items:center;gap:8px}
    .dot{width:10px;height:10px;border-radius:50%;background:transparent;border:2px solid transparent}
    .dot.active{background:var(--green);box-shadow:0 0 0 6px rgba(57,224,117,.18)}

    .divider{height:36px;width:2px;background:var(--divider);margin:4px auto;border-radius:99px}

    /* score board */
    .board{position:relative;display:grid;place-items:center;gap:16px;height:100%;}
    .scores{display:flex;align-items:center;gap:22px}
    .big{font-size:120px;line-height:1;font-weight:900;letter-spacing:2px}
    .big.blue{color:var(--blue)}
    .big.red{color:var(--red)}
    .big.white{color:var(--white);font-size:96px;opacity:.9}
    .dotSep{font-size:80px;opacity:.25}

    /* swipe pads */
    .pad{position:absolute;left:0;right:0;height:30%;display:grid;place-items:center;color:#9ca3af;user-select:none}
    .pad.top{top:0}
    .pad.bottom{bottom:0}
    .chev{width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;opacity:.9;filter:drop-shadow(0 4px 16px rgba(0,0,0,.4))}
    .chev.red{border-bottom:18px solid var(--red);transform:translateY(6px)}
    .chev.blue{border-top:18px solid var(--blue);transform:translateY(-6px)}

    .hint{position:absolute;left:50%;transform:translateX(-50%);bottom:14px;font-size:12px;color:#9ca3af;opacity:.7}

    /* bottom controls */
    .bottom{padding:10px 16px 18px;display:flex;justify-content:space-between;align-items:center;gap:8px}
    .mini{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:8px;opacity:.85}
    .mini .name{font-weight:700}

    .btn{background:#161823;border:1px solid #2a2d3a;color:#d1d5db;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .ghost{background:transparent}

    /* tap-targets on names for quick server selection */
    .tap{cursor:pointer;transition:opacity .2s}
    .tap:hover{opacity:.9}

    @media (max-width:420px){
      .big{font-size:96px}
      .big.white{font-size:80px}
    }
    .pad .chev{position:absolute}
  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- TOP: A team (upper names) -->
    <div class="top">
      <div class="names">
        <div class="cell"><span class="dot" id="dotA1"></span><span class="tap" id="nameA1">Awais</span></div>
        <div class="cell" style="justify-content:end"><span class="tap" id="nameA2">Haris</span><span class="dot" id="dotA2"></span></div>
      </div>
      <div class="divider"></div>
    </div>

    <!-- CENTER: Scores & swipe pads -->
    <div class="board" id="board">
            <div class="pad top" id="padTop" title="向上滑：上方勝該球">
        <div class="chev red" id="chevTop"></div>
      </div>
      </div>

      <div class="scores" aria-live="polite" aria-atomic="true">
        <div class="big blue" id="scoreA">0</div>
        <div class="dotSep">·</div>
        <div class="big red" id="scoreB">0</div>
        <div class="dotSep">·</div>
        <div class="big white" id="serverNum">2</div>
      </div>

            <div
      </div>
      <div class="hint">上滑紅色箭頭：B隊 +1 ｜ 下滑藍色箭頭：A隊 +1</div>
    </div>

    <!-- B team (lower names) + controls -->
    <div class="bottom">
      <div class="mini" style="width:56%">
        <div class="cell"><span class="dot" id="dotB1"></span><span class="tap" id="nameB1">Jov</span></div>
        <div style="height:36px;width:2px;background:var(--divider);border-radius:99px"></div>
        <div class="cell" style="justify-content:end"><span class="tap" id="nameB2">Sana</span><span class="dot active" id="dotB2"></span></div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="btn ghost" id="swapServe">交換發球方</button>
        <button class="btn" id="toggleServer">切換 1 / 2</button>
        <button class="btn" id="reset">重置</button>
      </div>
    </div>
  </div>

  <script>
    // --- State ---
    const state = {
      A: 0,
      B: 0,
      servingTeam: 'B',          // 'A' 或 'B'（起始與畫面一致：右下 B 隊發球）
      serverNumber: 2,           // 第三個數字：1 或 2，起始為 2（符合 0-0-2 開局習慣）
      serverSpot: 'B2',          // 畫面上的發球者位置（A1/A2/B1/B2）
    };

    // --- Elements ---
    const el = (id)=>document.getElementById(id);
    const scoreA   = el('scoreA');
    const scoreB   = el('scoreB');
    const serveNum = el('serverNum');
    const pads = { top: el('padTop'), bottom: el('padBottom') };

    const dots = { A1: el('dotA1'), A2: el('dotA2'), B1: el('dotB1'), B2: el('dotB2') };
    const names = { A1: el('nameA1'), A2: el('nameA2'), B1: el('nameB1'), B2: el('nameB2') };

    // --- Helpers ---
    function render(){
      scoreA.textContent = state.A;
      scoreB.textContent = state.B;
      serveNum.textContent = state.serverNumber;
      // refresh green dot
      for(const k of Object.keys(dots)) dots[k].classList.remove('active');
      dots[state.serverSpot]?.classList.add('active');
    }

    function setServerSpot(spot){
      state.serverSpot = spot;
      state.servingTeam = spot[0]; // 'A' or 'B'
      render();
    }

    function awardPoint(team){
      if(team === 'A') state.A++; else state.B++;
      // 規則簡化：發球方得分 -> 同一位球員持續發球（僅換場不換人），serverNumber 不變
      state.servingTeam = team;
      render();
    }

    function swapServingTeam(){
      state.servingTeam = state.servingTeam === 'A' ? 'B' : 'A';
      // 保持位置就近邏輯：如果當前在 A1/A2 就在 A 內切換；B 類似
      const spot = state.serverSpot;
      setServerSpot(state.servingTeam + spot.slice(1));
    }

    // 切換 1/2（發球順位）
    function toggleServerNumber(){
      state.serverNumber = state.serverNumber === 1 ? 2 : 1;
      render();
    }

    function resetAll(){
      state.A = 0; state.B = 0; state.servingTeam='B'; state.serverNumber=2; state.serverSpot='B2';
      render();
    }

    // --- Gestures (touch & mouse) on pads ---
    function attachSwipe(el, direction, onFire){
      let startY = null; let active=false;
      const threshold = 40; // px
      const onStart = (y)=>{ startY=y; active=true; };
      const onMove = (y)=>{
        if(!active||startY==null) return;
        const dy = y - startY;
        if(direction==='up'   && dy < -threshold){ active=false; onFire(); }
        if(direction==='down' && dy >  threshold){ active=false; onFire(); }
      };
      const onEnd = ()=>{ active=false; startY=null; };

      // touch
      el.addEventListener('touchstart',e=>onStart(e.touches[0].clientY),{passive:true});
      el.addEventListener('touchmove', e=>onMove(e.touches[0].clientY),{passive:true});
      el.addEventListener('touchend', onEnd);
      // mouse (drag)
      el.addEventListener('mousedown', e=>onStart(e.clientY));
      window.addEventListener('mousemove', e=>onMove(e.clientY));
      window.addEventListener('mouseup', onEnd);
    }

    attachSwipe(pads.top, 'up',   ()=>awardPoint('B'));
    attachSwipe(pads.bottom, 'down', ()=>awardPoint('A'));

    // quick set server by tapping a name
    for(const key of Object.keys(names)){
      names[key].addEventListener('click', ()=>setServerSpot(key));
      // 雙擊改名
      names[key].addEventListener('dblclick', ()=>{
        const current = names[key].textContent.trim();
        const next = prompt('修改選手名稱：', current);
        if(next!==null && next.trim()!=='') names[key].textContent = next.trim();
      });
    }

    // buttons
    el('swapServe').addEventListener('click', swapServingTeam);
    el('toggleServer').addEventListener('click', toggleServerNumber);
    el('reset').addEventListener('click', resetAll);

    // 初始渲染
    render();
  </script>
</body>
</html>
